_base_ = ['../../../_base_/default_runtime.py']

vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    type='Pose3dLocalVisualizer', vis_backends=vis_backends, name='visualizer')

# runtime
train_cfg = dict(max_epochs=100, val_interval=10)

# optimizer
optim_wrapper = dict(
    type='OptimWrapper',
    optimizer=dict(type='Adam', lr=1e-3),
    clip_grad=dict(max_norm=0.1, norm_type=2))

# learning policy
param_scheduler = [
    dict(type='StepLR', step_size=100000, gamma=0.96, end=80, by_epoch=False)
]

auto_scale_lr = dict(base_batch_size=4096)

# hooks
default_hooks = dict(
    checkpoint=dict(
        type='CheckpointHook',
        save_best='MPJPE',
        rule='less',
        max_keep_ckpts=1))

# codec settings
# 3D keypoint normalization parameters
# From file: '{data_root}/annotation_body3d/fps50/joint3d_rel_stats.pkl'
target_mean = [[0.11144055, -0.9860889, 5.0122223],
               [0.11192899, -1.0142756, 5.0057983],
               [0.11176176, -1.0110438, 5.0067635],
               [0.11228593, -1.0058825, 5.0077515],
               [0.11193851, -1.0010347, 5.0092664],
               [0.11053552, -0.8415431, 5.0444956],
               [0.10982758, -0.8383377, 5.0462346],
               [0.10817584, -0.64167243, 5.0888658],
               [0.10701484, -0.64961517, 5.08896],
               [0.10675418, -0.57616526, 5.1033983],
               [0.10630775, -0.6231766, 5.0945244],
               [0.10470568, -0.40194947, 5.143381],
               [0.10423286, -0.40073884, 5.144326],
               [0.09980242, -0.07511459, 5.216503],
               [0.09931749, -0.07652084, 5.2169952],
               [0.0950117, 0.29819974, 5.300328],
               [0.09457245, 0.29702964, 5.3010097],
               [0.09365287, 0.35394198, 5.3124404],
               [0.09390336, 0.3563218, 5.3128967],
               [0.09462694, 0.33859327, 5.3096166],
               [0.093149, 0.3542868, 5.313615],
               [0.09325755, 0.3541682, 5.31384],
               [0.09420236, 0.3385108, 5.3103943],
               [0.11185325, -1.0118082, 5.0068245],
               [0.11165056, -0.99603426, 5.010352],
               [0.11147051, -0.9810947, 5.013702],
               [0.11126118, -0.9643229, 5.017488],
               [0.11109222, -0.950363, 5.020559],
               [0.11094715, -0.9378758, 5.0233393],
               [0.11079908, -0.9261848, 5.025856],
               [0.11072694, -0.91859317, 5.027483],
               [0.11073579, -0.91683847, 5.027906],
               [0.11080801, -0.91973114, 5.0271506],
               [0.11098216, -0.9306191, 5.0246425],
               [0.11115848, -0.9413448, 5.0222116],
               [0.11138692, -0.95678455, 5.0186825],
               [0.11159679, -0.97170264, 5.0153356],
               [0.11179326, -0.9861987, 5.012106],
               [0.11199242, -1.0013133, 5.0086627],
               [0.11222292, -1.0190797, 5.004631],
               [0.11191105, -1.0233426, 5.004017],
               [0.11197928, -1.0283709, 5.002915],
               [0.11198292, -1.0289482, 5.002743],
               [0.11196374, -1.0269729, 5.0031447],
               [0.11196946, -1.0273334, 5.003043],
               [0.11203025, -1.0287305, 5.002618],
               [0.11208882, -1.0308954, 5.002118],
               [0.11213648, -1.0315775, 5.001906],
               [0.11217765, -1.0318373, 5.001827],
               [0.11217728, -1.0295976, 5.002332],
               [0.11178422, -1.0117947, 5.0064654],
               [0.11163734, -1.0014441, 5.0088115],
               [0.11149184, -0.99183506, 5.010943],
               [0.11134789, -0.98219895, 5.0130777],
               [0.11127052, -0.97359455, 5.0150948],
               [0.11126588, -0.9730543, 5.0152197],
               [0.11126848, -0.9720309, 5.0153904],
               [0.11128078, -0.97198397, 5.015414],
               [0.11135191, -0.9755663, 5.014598],
               [0.11173237, -1.0089383, 5.007325],
               [0.11175235, -1.0104696, 5.0069284],
               [0.11179457, -1.0130845, 5.006259],
               [0.11176191, -1.009741, 5.0069876],
               [0.11170487, -1.005963, 5.007886],
               [0.1116977, -1.0057124, 5.0079913],
               [0.11184572, -1.0113587, 5.006498],
               [0.11191358, -1.0148596, 5.005696],
               [0.11191934, -1.0136538, 5.0059457],
               [0.11192775, -1.0127503, 5.0061183],
               [0.11188742, -1.0111693, 5.006504],
               [0.11185171, -1.0100781, 5.00681],
               [0.11103959, -0.95311075, 5.019752],
               [0.11107582, -0.9561977, 5.019003],
               [0.11109852, -0.9588545, 5.018366],
               [0.11110886, -0.95915127, 5.0182924],
               [0.11109906, -0.95787716, 5.0185456],
               [0.11112448, -0.95633537, 5.0189047],
               [0.11115529, -0.954821, 5.019157],
               [0.11107533, -0.95080304, 5.020135],
               [0.11100062, -0.9469293, 5.0209794],
               [0.11094715, -0.9449953, 5.021495],
               [0.11094535, -0.9456394, 5.021321],
               [0.11100646, -0.9500044, 5.0204053],
               [0.11103735, -0.95269346, 5.0198174],
               [0.11104706, -0.9532113, 5.0196624],
               [0.11105973, -0.95470935, 5.0193233],
               [0.11112326, -0.9560155, 5.018977],
               [0.11114416, -0.9548453, 5.0191674],
               [0.11108721, -0.9526075, 5.0197287],
               [0.11102607, -0.95143044, 5.020049],
               [0.11103274, -0.9517319, 5.02001],
               [0.10664381, -0.57068086, 5.1046433],
               [0.10652415, -0.56722593, 5.1054416],
               [0.10642228, -0.5654994, 5.1058145],
               [0.10628584, -0.55969995, 5.107094],
               [0.10612439, -0.55032414, 5.109245],
               [0.10631636, -0.5612959, 5.1067166],
               [0.10612341, -0.55058026, 5.109083],
               [0.10598263, -0.54242176, 5.1109314],
               [0.10591317, -0.5385585, 5.1118016],
               [0.10625622, -0.55497783, 5.108104],
               [0.10603557, -0.54252934, 5.1108656],
               [0.10592102, -0.53563106, 5.1124806],
               [0.10586057, -0.5320969, 5.113208],
               [0.10618633, -0.54748625, 5.109746],
               [0.10598791, -0.5356107, 5.112401],
               [0.10588845, -0.53023344, 5.113596],
               [0.10582733, -0.52656925, 5.1144753],
               [0.10612071, -0.5394896, 5.111504],
               [0.10598357, -0.5318702, 5.113209],
               [0.10592322, -0.5286341, 5.113956],
               [0.10585353, -0.52503365, 5.114844],
               [0.10626543, -0.6201362, 5.0952196],
               [0.10622706, -0.6203042, 5.095128],
               [0.106218, -0.62234837, 5.0946326],
               [0.10611945, -0.6188201, 5.0953856],
               [0.10599729, -0.61211497, 5.0968666],
               [0.10609834, -0.6199454, 5.0951467],
               [0.10595801, -0.61247873, 5.096809],
               [0.10586261, -0.6054466, 5.0983796],
               [0.10583136, -0.6027688, 5.098923],
               [0.10600632, -0.6137084, 5.0966535],
               [0.10585261, -0.60434616, 5.0985866],
               [0.10578441, -0.5984275, 5.099857],
               [0.10574424, -0.59531647, 5.100608],
               [0.10591643, -0.60584867, 5.0983768],
               [0.10576376, -0.59671825, 5.1003428],
               [0.10571171, -0.5919393, 5.101468],
               [0.10567412, -0.58847296, 5.1022267],
               [0.10582101, -0.5979337, 5.1001916],
               [0.10573406, -0.59230584, 5.1014237],
               [0.10569759, -0.5892673, 5.1020646],
               [0.10566365, -0.5857031, 5.102879]],
target_std = [[0.46969497, 0.24376394, 0.7797492],
              [0.46324456, 0.24308331, 0.7700793],
              [0.47882375, 0.24386045, 0.78354895],
              [0.45450675, 0.23892416, 0.7413074],
              [0.49044672, 0.2407949, 0.77275276],
              [0.44717136, 0.23250958, 0.7112315],
              [0.5240134, 0.23626824, 0.7830721],
              [0.45608258, 0.24600591, 0.6988865],
              [0.57544243, 0.25946924, 0.8169292],
              [0.46614936, 0.29010627, 0.7334095],
              [0.5833322, 0.31216726, 0.8445777],
              [0.4540643, 0.2128997, 0.7100094],
              [0.50924486, 0.21631011, 0.75957227],
              [0.48107055, 0.18047225, 0.75493526],
              [0.5291254, 0.1831084, 0.8050851],
              [0.49872896, 0.18268456, 0.7488433],
              [0.54476124, 0.1865486, 0.7978145],
              [0.50589454, 0.1841944, 0.78900135],
              [0.4994397, 0.18208072, 0.76650023],
              [0.50255615, 0.18409987, 0.74313056],
              [0.5539806, 0.18720335, 0.8373312],
              [0.5685924, 0.18743534, 0.8389725],
              [0.5446824, 0.18783481, 0.7880359],
              [0.49605432, 0.24382848, 0.7875681],
              [0.4949976, 0.2437139, 0.7868435],
              [0.4930541, 0.24356222, 0.785091],
              [0.491554, 0.24337529, 0.7838103],
              [0.48804545, 0.24310075, 0.7813481],
              [0.48381972, 0.24283007, 0.77835906],
              [0.47951773, 0.24262956, 0.77593946],
              [0.47464937, 0.24243592, 0.7721895],
              [0.46931478, 0.24214931, 0.76794493],
              [0.46419507, 0.24199542, 0.76379144],
              [0.46022016, 0.24197939, 0.7603967],
              [0.4577605, 0.24211481, 0.75740707],
              [0.45576468, 0.24224773, 0.75506955],
              [0.45469865, 0.2424747, 0.7538674],
              [0.45434773, 0.24257599, 0.75355285],
              [0.45426273, 0.24251851, 0.75335276],
              [0.45438242, 0.24262732, 0.75368243],
              [0.48554847, 0.24453938, 0.7878035],
              [0.4823663, 0.24456368, 0.78636575],
              [0.48035404, 0.24462822, 0.7856756],
              [0.47708857, 0.24470372, 0.7840148],
              [0.4750969, 0.24457881, 0.7832538],
              [0.46862522, 0.24438216, 0.7781424],
              [0.46622717, 0.24421866, 0.77531546],
              [0.4636401, 0.2440052, 0.7718085],
              [0.46145356, 0.24379493, 0.76884174],
              [0.45953426, 0.24367212, 0.76605105],
              [0.47134966, 0.24393506, 0.7806038],
              [0.4710093, 0.24403405, 0.7810387],
              [0.47144964, 0.24434148, 0.7825719],
              [0.4709584, 0.244388, 0.78315264],
              [0.47447863, 0.24397033, 0.78251654],
              [0.47276348, 0.2439001, 0.781505],
              [0.47059837, 0.24387519, 0.77976453],
              [0.4687661, 0.24386117, 0.7782563],
              [0.46611688, 0.24374121, 0.77565277],
              [0.4828706, 0.24411994, 0.78593683],
              [0.48109183, 0.24416052, 0.785318],
              [0.47809243, 0.24411976, 0.7836226],
              [0.4754907, 0.24379501, 0.7818203],
              [0.477976, 0.24403067, 0.7832453],
              [0.48012817, 0.2440565, 0.78442734],
              [0.466835, 0.24375445, 0.77472216],
              [0.4649908, 0.24370517, 0.77269775],
              [0.4629512, 0.24368474, 0.77034765],
              [0.46143502, 0.24343969, 0.76847136],
              [0.4629029, 0.24348113, 0.7702519],
              [0.4648137, 0.24360977, 0.77249575],
              [0.47611314, 0.24313562, 0.7805633],
              [0.47374767, 0.24354479, 0.78011906],
              [0.47126123, 0.24364363, 0.77974045],
              [0.4700832, 0.24356432, 0.7788293],
              [0.46894744, 0.24360737, 0.77804697],
              [0.46626484, 0.24316761, 0.77418065],
              [0.46380666, 0.24293701, 0.7701287],
              [0.46582, 0.2428111, 0.7726783],
              [0.46743506, 0.24287991, 0.7747356],
              [0.46993864, 0.24293558, 0.77751493],
              [0.47202536, 0.2429966, 0.77883106],
              [0.47403646, 0.24304336, 0.779522],
              [0.4758049, 0.24328049, 0.7804295],
              [0.47239432, 0.2433096, 0.77883077],
              [0.47027206, 0.2435318, 0.7784078],
              [0.46693328, 0.24329525, 0.7743104],
              [0.46475568, 0.24288052, 0.77117336],
              [0.46671966, 0.24284348, 0.7737357],
              [0.4699812, 0.2429737, 0.77774113],
              [0.47265792, 0.24301879, 0.77884394],
              [0.46826974, 0.29622486, 0.73806506],
              [0.46951014, 0.30500606, 0.7429861],
              [0.4711287, 0.31441063, 0.74851793],
              [0.4743551, 0.32346007, 0.7533631],
              [0.4775051, 0.33198294, 0.7574825],
              [0.47708288, 0.32326093, 0.7534664],
              [0.48073876, 0.33288026, 0.7583222],
              [0.48277783, 0.33792007, 0.7615714],
              [0.48437637, 0.3413295, 0.7636921],
              [0.47872594, 0.3226799, 0.752408],
              [0.482285, 0.3323034, 0.75776464],
              [0.48393553, 0.33647233, 0.7603444],
              [0.48518422, 0.33962077, 0.76195645],
              [0.4793249, 0.32121196, 0.7510293],
              [0.48242265, 0.32972512, 0.7551667],
              [0.48383594, 0.33296403, 0.75787526],
              [0.48484945, 0.33557743, 0.75957346],
              [0.4796388, 0.3185943, 0.7487438],
              [0.48186988, 0.32460868, 0.7522578],
              [0.48271677, 0.32735175, 0.75393295],
              [0.4834352, 0.32961252, 0.75591195],
              [0.5845377, 0.3186801, 0.8475968],
              [0.5820405, 0.32743397, 0.8483906],
              [0.58062947, 0.33663735, 0.85047215],
              [0.58140826, 0.34633464, 0.853475],
              [0.58258396, 0.35529694, 0.8563945],
              [0.5916214, 0.34780073, 0.8609989],
              [0.5924252, 0.3578275, 0.8639025],
              [0.5916726, 0.36301035, 0.86432517],
              [0.5901393, 0.3662654, 0.8638153],
              [0.59479606, 0.3480714, 0.86247724],
              [0.5949844, 0.3579263, 0.86491483],
              [0.5934021, 0.3619045, 0.8643258],
              [0.59119844, 0.3649416, 0.8631553],
              [0.5965028, 0.34659353, 0.8626234],
              [0.59619486, 0.3555423, 0.8644227],
              [0.5945059, 0.3583577, 0.8636595],
              [0.5930168, 0.3607604, 0.86322844],
              [0.59731334, 0.3436244, 0.86217177],
              [0.59720355, 0.35013503, 0.8635457],
              [0.5956155, 0.35252902, 0.86292624],
              [0.59469336, 0.35483047, 0.86259687]]

keypoints_mean = [[536.64954, 278.6998], [537.0272, 271.81763],
                  [536.3182, 272.5185], [537.2225, 274.05975],
                  [535.80304, 275.0229], [536.8336, 314.23364],
                  [534.2819, 314.70673], [536.54095, 362.0759],
                  [532.75525, 360.02567], [536.6876, 377.44418],
                  [532.95544, 366.19357], [534.3273, 418.15063],
                  [532.7063, 418.55243], [533.85394, 493.51324],
                  [531.6948, 493.60526], [531.8644, 576.1229],
                  [530.288, 576.53876], [532.36304, 589.01434],
                  [532.5746, 589.13544], [531.45087, 584.78485],
                  [530.1812, 589.84644], [529.655, 589.7938],
                  [530.1564, 585.4091], [535.61816, 272.29163],
                  [535.575, 276.18185], [535.55804, 279.8621],
                  [535.5372, 283.9871], [535.5934, 287.4211],
                  [535.67413, 290.4912], [535.7897, 293.36942],
                  [535.9476, 295.23788], [536.1539, 295.6896],
                  [536.39825, 295.00937], [536.6481, 292.37372],
                  [536.8154, 289.76752], [537.0023, 286.0106],
                  [537.1464, 282.36682], [537.2514, 278.81754],
                  [537.3401, 275.10687], [537.4254, 270.74268],
                  [536.09247, 269.45862], [536.2412, 268.23148],
                  [536.33777, 268.0941], [536.4818, 268.5988],
                  [536.5809, 268.51837], [536.8807, 268.2148],
                  [536.9948, 267.70258], [537.1121, 267.55737],
                  [537.2127, 267.5108], [537.2939, 268.08063],
                  [536.68, 272.3763], [536.6517, 274.9218], [536.6146, 277.28],
                  [536.6091, 279.65546], [536.3415, 281.7534],
                  [536.4183, 281.89285], [536.51416, 282.15756],
                  [536.5986, 282.18094], [536.7299, 281.3121],
                  [536.1221, 273.0235], [536.21234, 272.6545],
                  [536.345, 272.02332], [536.44385, 272.86014],
                  [536.32086, 273.77872], [536.22943, 273.8296],
                  [536.8487, 272.51514], [536.9519, 271.66513],
                  [537.0484, 271.97867], [537.124, 272.2137],
                  [537.04156, 272.59042], [536.94446, 272.8488],
                  [536.1179, 286.7791], [536.2538, 286.03033],
                  [536.4071, 285.3836], [536.4634, 285.3206],
                  [536.5151, 285.63828], [536.6064, 286.034],
                  [536.6832, 286.42526], [536.5785, 287.39456],
                  [536.49585, 288.33255], [536.3765, 288.79575],
                  [536.2813, 288.6245], [536.2014, 287.55],
                  [536.1309, 286.87662], [536.2988, 286.7659],
                  [536.42786, 286.4092], [536.5585, 286.11374],
                  [536.6469, 286.4115], [536.544, 286.94708],
                  [536.4133, 287.21536], [536.27496, 287.1303],
                  [536.6622, 378.7273], [536.60657, 379.49384],
                  [536.54694, 379.85556], [536.54474, 381.18286],
                  [536.4932, 383.35318], [536.7601, 380.83786],
                  [536.71857, 383.32846], [536.6294, 385.21994],
                  [536.5653, 386.11276], [536.81165, 382.3407],
                  [536.7218, 385.23328], [536.62646, 386.83014],
                  [536.5661, 387.64047], [536.78864, 384.1179],
                  [536.7225, 386.8731], [536.6309, 388.12],
                  [536.5521, 388.96716], [536.7568, 386.00925],
                  [536.7085, 387.77914], [536.6519, 388.52307],
                  [536.5757, 389.35767], [532.94763, 366.90884],
                  [533.0592, 366.8181], [533.1751, 366.29083],
                  [533.2421, 367.08685], [533.293, 368.64008],
                  [533.0633, 366.85254], [533.1281, 368.58405],
                  [533.181, 370.22098], [533.2633, 370.8217],
                  [532.9905, 368.33435], [533.06494, 370.51315],
                  [533.1318, 371.88474], [533.19824, 372.58777],
                  [532.9219, 370.2158], [533.0049, 372.33905],
                  [533.065, 373.44696], [533.1185, 374.24524],
                  [532.8678, 372.11362], [532.93976, 373.4169],
                  [532.9962, 374.11588], [533.0272, 374.93533]]
keypoints_std = [[106.93339, 57.479305], [105.56519, 57.90509],
                 [109.4624, 57.980694], [103.658966, 56.98827],
                 [112.89688, 57.291306], [100.70107, 53.286736],
                 [120.75021, 53.777256], [101.218666, 55.176514],
                 [132.39244, 58.090347], [103.05917, 66.24139],
                 [133.45999, 71.734604], [100.10109, 46.958645],
                 [114.44433, 47.277348], [104.33424, 43.154987],
                 [116.06031, 43.937065], [106.65799, 50.648563],
                 [118.04612, 52.806835], [107.296745, 52.955803],
                 [106.03674, 52.070473], [107.53533, 51.668198],
                 [118.88619, 55.364414], [122.62965, 55.503403],
                 [118.05185, 53.832394], [113.97585, 58.02224],
                 [113.601204, 57.70803], [113.016235, 57.417637],
                 [112.52953, 57.088844], [111.547455, 56.810883],
                 [110.39197, 56.56429], [109.215904, 56.34578],
                 [107.94431, 56.214054], [106.59564, 56.150917],
                 [105.33498, 56.175457], [104.41253, 56.34103],
                 [103.88899, 56.548294], [103.499954, 56.825783],
                 [103.336975, 57.117752], [103.342964, 57.373936],
                 [103.42473, 57.616028], [103.56985, 57.94358],
                 [111.22549, 58.35497], [110.44053, 58.4498],
                 [109.9221, 58.4687], [109.07657, 58.435966],
                 [108.56076, 58.396317], [106.95048, 58.37494],
                 [106.381874, 58.38874], [105.7681, 58.374084],
                 [105.243126, 58.344383], [104.77358, 58.2847],
                 [107.51003, 57.93625], [107.33905, 57.7648],
                 [107.360245, 57.637352], [107.15303, 57.468323],
                 [108.03597, 57.276466], [107.595276, 57.25101],
                 [107.052666, 57.231033], [106.60606, 57.238655],
                 [105.98827, 57.28558], [110.45094, 57.984097],
                 [110.0024, 58.017445], [109.2482, 58.054226],
                 [108.573135, 57.907757], [109.182976, 57.89983],
                 [109.73055, 57.904335], [106.427925, 57.937412],
                 [106., 58.00315], [105.496254, 57.984573],
                 [105.12102, 57.910534], [105.4692, 57.885784],
                 [105.9271, 57.884678], [108.38103, 56.798836],
                 [107.77595, 56.931595], [107.14279, 56.971138],
                 [106.84882, 56.963326], [106.55214, 56.947475],
                 [105.91346, 56.8591], [105.32679, 56.82518],
                 [105.78324, 56.70421], [106.14699, 56.639088],
                 [106.739456, 56.597736], [107.27005, 56.624523],
                 [107.82508, 56.71667], [108.30047, 56.82496],
                 [107.42322, 56.83101], [106.87478, 56.889133],
                 [106.08267, 56.893948], [105.560356, 56.805386],
                 [106.01327, 56.73727], [106.78936, 56.710186],
                 [107.48673, 56.735046], [103.50498, 67.75587],
                 [103.7938, 69.94565], [104.18369, 72.28799],
                 [104.93002, 74.51282], [105.62772, 76.59241],
                 [105.606155, 74.4957], [106.42261, 76.8453],
                 [106.84733, 78.043816], [107.20022, 78.852264],
                 [105.95785, 74.32935], [106.72514, 76.66895],
                 [107.06305, 77.655945], [107.34235, 78.39618],
                 [106.0332, 73.929955], [106.702576, 76.00629],
                 [106.991714, 76.760704], [107.202576, 77.36563],
                 [106.04554, 73.23993], [106.52436, 74.710045],
                 [106.70114, 75.3633], [106.837555, 75.885735],
                 [133.66046, 73.37718], [132.9719, 75.62882],
                 [132.55623, 77.97711], [132.6679, 80.42973],
                 [132.87845, 82.66819], [135.18307, 80.80341],
                 [135.28876, 83.32304], [135.05692, 84.586105],
                 [134.6764, 85.39723], [135.95175, 80.856995],
                 [135.90016, 83.315834], [135.48515, 84.284966],
                 [134.93913, 85.0364], [136.35426, 80.440094],
                 [136.18715, 82.680046], [135.75456, 83.360596],
                 [135.37453, 83.92921], [136.5322, 79.636246],
                 [136.45203, 81.27055], [136.05135, 81.85991],
                 [135.8103, 82.40865]]
codec = dict(
    type='ImagePoseLifting',
    num_keypoints=133,
    root_index=(11, 12),
    remove_root=False,
)

# model settings
model = dict(
    type='PoseLifter',
    backbone=dict(
        type='LargeSimpleBaseline', in_channels=133 * 2, channels=1024),
    head=dict(
        type='TemporalRegressionHead',
        in_channels=1024,
        num_joints=133,
        loss=dict(type='MSELoss'),
        decoder=codec,
    ))

# base dataset settings
dataset_type = 'H3WBDataset'
data_root = 'data/h36m/'

# pipelines
train_pipeline = [
    dict(type='GenerateTarget', encoder=codec),
    dict(
        type='PackPoseInputs',
        meta_keys=('id', 'category_id', 'target_img_path', 'flip_indices',
                   'target_root', 'target_root_index', 'target_mean',
                   'target_std'))
]
val_pipeline = train_pipeline

# data loaders
train_dataloader = dict(
    batch_size=512,
    num_workers=4,
    persistent_workers=True,
    sampler=dict(type='DefaultSampler', shuffle=True),
    dataset=dict(
        type='MPII3DHPWBDataset',
        ann_file='mpii_3dhp_train.npz',
        seq_len=1,
        causal=True,
        data_root='data/mpii_3dhp/',
        data_prefix=dict(img=''),
        subset_frac=0.01,
        pipeline=train_pipeline,
    ))
val_dataloader = dict(
    batch_size=512,
    num_workers=2,
    persistent_workers=True,
    drop_last=False,
    sampler=dict(type='DefaultSampler', shuffle=False, round_up=False),
    dataset=dict(
        type=dataset_type,
        ann_file='annotation_body3d/h3wb_train.npz',
        seq_len=1,
        causal=True,
        data_root=data_root,
        data_prefix=dict(img='images/'),
        pipeline=train_pipeline,
        train_mode=False,
    ))
test_dataloader = val_dataloader

# evaluators
val_evaluator = [
    dict(type='SimpleMPJPE', mode='mpjpe'),
    dict(type='SimpleMPJPE', mode='p-mpjpe')
]
test_evaluator = val_evaluator
