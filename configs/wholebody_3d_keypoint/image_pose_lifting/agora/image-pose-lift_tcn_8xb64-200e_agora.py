_base_ = ['../../../_base_/default_runtime.py']

vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    type='Pose3dLocalVisualizer', vis_backends=vis_backends, name='visualizer')

# runtime
train_cfg = dict(max_epochs=200, val_interval=10)

# optimizer
optim_wrapper = dict(optimizer=dict(type='Adam', lr=1e-3))

# learning policy
param_scheduler = [
    dict(type='StepLR', step_size=100000, gamma=0.96, end=80, by_epoch=False)
]

auto_scale_lr = dict(base_batch_size=512)

# hooks
default_hooks = dict(
    checkpoint=dict(
        type='CheckpointHook',
        save_best='MPJPE',
        rule='less',
        max_keep_ckpts=1))

# codec settings
# 3D keypoint normalization parameters
# From file: '{data_root}/annotation_body3d/fps50/joint3d_rel_stats.pkl'
target_mean = [
    [1.77683729e-03, 2.46328251e-01, 6.58821492e+00],
    [-2.49809991e-03, 2.04004380e-01, 6.58265640e+00],
    [6.24221977e-03, 2.03428943e-01, 6.58332863e+00],
    [-7.06233214e-03, 2.11168813e-01, 6.57010978e+00],
    [1.20287410e-02, 2.17221176e-01, 6.57182136e+00],
    [-1.96390960e-02, 4.09780006e-01, 6.56111279e+00],
    [2.42025674e-02, 4.08649880e-01, 6.57246176e+00],
    [-3.28827422e-02, 6.50598016e-01, 6.55828547e+00],
    [3.21413595e-02, 6.40223240e-01, 6.57325145e+00],
    [-2.74964798e-02, 7.43120828e-01, 6.58411919e+00],
    [1.47178935e-02, 7.02651761e-01, 6.58200443e+00],
    [-7.78504868e-03, 9.16778446e-01, 6.56858675e+00],
    [7.79248466e-03, 9.22611826e-01, 6.57402976e+00],
    [-2.79994343e-02, 1.21761951e+00, 6.57704310e+00],
    [8.19042118e-03, 1.21632540e+00, 6.59071005e+00],
    [-2.39877271e-02, 1.59385763e+00, 6.57943627e+00],
    [-7.70588846e-04, 1.59955186e+00, 6.58276545e+00],
    [-3.65347678e-02, 1.67457729e+00, 6.60050769e+00],
    [-4.08724888e-02, 1.67519217e+00, 6.59091945e+00],
    [-2.13467513e-02, 1.61950296e+00, 6.57274609e+00],
    [-5.79355770e-03, 1.67863218e+00, 6.60651878e+00],
    [5.02732124e-03, 1.68006169e+00, 6.60093410e+00],
    [-1.41492862e-03, 1.63770314e+00, 6.57365275e+00],
    [-2.74964798e-02, 7.43120828e-01, 6.58411919e+00],
    [-2.36643836e-02, 7.44757956e-01, 6.58724472e+00],
    [-2.16121160e-02, 7.49394097e-01, 6.58910891e+00],
    [-1.99796560e-02, 7.52745912e-01, 6.59107336e+00],
    [-1.77114682e-02, 7.58419311e-01, 6.59398421e+00],
    [-2.27106123e-02, 7.53614793e-01, 6.59316188e+00],
    [-2.07966670e-02, 7.62068100e-01, 6.59542847e+00],
    [-2.00622901e-02, 7.67063826e-01, 6.59539511e+00],
    [-1.98700967e-02, 7.70495440e-01, 6.59493291e+00],
    [-2.36523534e-02, 7.62949507e-01, 6.59452099e+00],
    [-2.19562132e-02, 7.71004395e-01, 6.59625875e+00],
    [-2.15369533e-02, 7.73972321e-01, 6.59588810e+00],
    [-2.15843810e-02, 7.75282880e-01, 6.59492849e+00],
    [-2.48572079e-02, 7.70846694e-01, 6.59406238e+00],
    [-2.34172554e-02, 7.76368008e-01, 6.59567256e+00],
    [-2.30661273e-02, 7.78236621e-01, 6.59526328e+00],
    [-2.30498431e-02, 7.77976459e-01, 6.59440364e+00],
    [-2.56166829e-02, 7.76610374e-01, 6.59330154e+00],
    [-2.49273768e-02, 7.79749767e-01, 6.59407762e+00],
    [-2.45394484e-02, 7.81532987e-01, 6.59397125e+00],
    [-2.46786818e-02, 7.82245906e-01, 6.59354715e+00],
    [1.47178935e-02, 7.02651761e-01, 6.58200443e+00],
    [1.19222574e-02, 6.96930754e-01, 6.58280622e+00],
    [1.04463750e-02, 6.97642447e-01, 6.58237903e+00],
    [9.54329092e-03, 6.97749939e-01, 6.58303058e+00],
    [8.26280011e-03, 6.99126947e-01, 6.58249794e+00],
    [1.07781022e-02, 7.03151327e-01, 6.58680752e+00],
    [9.58163645e-03, 7.08364277e-01, 6.58768577e+00],
    [8.60091904e-03, 7.11148336e-01, 6.58712464e+00],
    [7.44607794e-03, 7.12516554e-01, 6.58672280e+00],
    [1.06028606e-02, 7.13938542e-01, 6.58754876e+00],
    [9.36066831e-03, 7.19780552e-01, 6.58740920e+00],
    [8.15425471e-03, 7.21679647e-01, 6.58654009e+00],
    [7.09652591e-03, 7.22009005e-01, 6.58581986e+00],
    [1.06252373e-02, 7.23996267e-01, 6.58691490e+00],
    [9.21687134e-03, 7.27744810e-01, 6.58638014e+00],
    [7.88545925e-03, 7.28987581e-01, 6.58501623e+00],
    [7.01530407e-03, 7.28080056e-01, 6.58404044e+00],
    [1.05417306e-02, 7.31190114e-01, 6.58600326e+00],
    [9.26972960e-03, 7.33578623e-01, 6.58541511e+00],
    [8.14597037e-03, 7.34954331e-01, 6.58407904e+00],
    [7.21445391e-03, 7.35002894e-01, 6.58284424e+00],
    [1.15277805e-02, 2.01772108e-01, 6.57652691e+00],
    [1.12799112e-02, 2.19922382e-01, 6.57761765e+00],
    [1.08324715e-02, 2.37773428e-01, 6.57777358e+00],
    [1.07999525e-02, 2.54482821e-01, 6.57796093e+00],
    [1.00929130e-02, 2.71242647e-01, 6.57910095e+00],
    [8.76152640e-03, 2.86336160e-01, 6.58025202e+00],
    [6.84488563e-03, 2.99576335e-01, 6.58179606e+00],
    [4.32109425e-03, 3.10127489e-01, 6.58367834e+00],
    [1.98840171e-03, 3.13351374e-01, 6.58397462e+00],
    [-2.70820451e-04, 3.10391420e-01, 6.58317839e+00],
    [-2.38272051e-03, 2.99764833e-01, 6.58075590e+00],
    [-3.95795418e-03, 2.86107798e-01, 6.57887943e+00],
    [-5.05368969e-03, 2.70588504e-01, 6.57762069e+00],
    [-5.37337669e-03, 2.53688604e-01, 6.57646350e+00],
    [-5.85614179e-03, 2.36704108e-01, 6.57641673e+00],
    [-6.15918960e-03, 2.18941371e-01, 6.57614294e+00],
    [-6.69109377e-03, 2.01247911e-01, 6.57508697e+00],
    [1.02952011e-02, 1.96967163e-01, 6.58059709e+00],
    [9.12127229e-03, 1.84315132e-01, 6.58250508e+00],
    [7.11752771e-03, 1.83183878e-01, 6.58410416e+00],
    [5.02262908e-03, 1.86044080e-01, 6.58487882e+00],
    [3.22058282e-03, 1.90468272e-01, 6.58500864e+00],
    [8.30665744e-04, 1.90396556e-01, 6.58477237e+00],
    [-9.07881706e-04, 1.85806104e-01, 6.58433470e+00],
    [-2.96376447e-03, 1.82760304e-01, 6.58317391e+00],
    [-4.79868491e-03, 1.84305433e-01, 6.58125613e+00],
    [-5.83929090e-03, 1.97004331e-01, 6.57909891e+00],
    [1.98174752e-03, 2.05170554e-01, 6.58531039e+00],
    [1.91464922e-03, 2.17157554e-01, 6.58642287e+00],
    [1.84393928e-03, 2.27839954e-01, 6.58747955e+00],
    [1.76825955e-03, 2.38771867e-01, 6.58844488e+00],
    [3.54236318e-03, 2.46051941e-01, 6.58566188e+00],
    [2.75833763e-03, 2.49061814e-01, 6.58609066e+00],
    [1.86694895e-03, 2.51378368e-01, 6.58623805e+00],
    [9.99411631e-04, 2.49019218e-01, 6.58589647e+00],
    [2.44762945e-04, 2.45967930e-01, 6.58529877e+00],
    [8.18540213e-03, 2.04992162e-01, 6.58246121e+00],
    [6.97088269e-03, 2.01739673e-01, 6.58356727e+00],
    [5.64420816e-03, 2.02110758e-01, 6.58352964e+00],
    [4.55833996e-03, 2.06931051e-01, 6.58316089e+00],
    [5.56736076e-03, 2.09438731e-01, 6.58347481e+00],
    [6.85579122e-03, 2.09659690e-01, 6.58343948e+00],
    [-3.30176009e-04, 2.06719230e-01, 6.58269438e+00],
    [-1.41779752e-03, 2.01844309e-01, 6.58288607e+00],
    [-2.72072156e-03, 2.01344290e-01, 6.58266310e+00],
    [-3.88708544e-03, 2.04491674e-01, 6.58136558e+00],
    [-2.67899665e-03, 2.09332333e-01, 6.58255706e+00],
    [-1.37970078e-03, 2.09124512e-01, 6.58280765e+00],
    [5.22892819e-03, 2.68926938e-01, 6.58417285e+00],
    [4.09578178e-03, 2.64796251e-01, 6.58552260e+00],
    [2.69953054e-03, 2.63575772e-01, 6.58612975e+00],
    [1.84287529e-03, 2.64339517e-01, 6.58613672e+00],
    [9.70744372e-04, 2.63508024e-01, 6.58593950e+00],
    [-3.40546228e-04, 2.64504066e-01, 6.58503213e+00],
    [-1.22978540e-03, 2.68834001e-01, 6.58350618e+00],
    [-3.76488909e-04, 2.75211861e-01, 6.58464055e+00],
    [9.92604593e-04, 2.78289759e-01, 6.58564032e+00],
    [1.93500537e-03, 2.78788789e-01, 6.58585151e+00],
    [2.85779121e-03, 2.78388970e-01, 6.58585769e+00],
    [4.29609130e-03, 2.75340029e-01, 6.58515752e+00],
    [5.14575276e-03, 2.68861847e-01, 6.58409443e+00],
    [2.72056349e-03, 2.68183732e-01, 6.58535441e+00],
    [1.85755771e-03, 2.68362869e-01, 6.58534032e+00],
    [1.01496815e-03, 2.68069184e-01, 6.58519139e+00],
    [-1.19813929e-03, 2.68766211e-01, 6.58350419e+00],
    [9.90490929e-04, 2.71393144e-01, 6.58512127e+00],
    [1.93425900e-03, 2.71407862e-01, 6.58530505e+00],
    [2.89729117e-03, 2.71394223e-01, 6.58531663e+00],
]
target_std = [
    [0.13984908, 0.25473181, 1.47359062],
    [0.13778042, 0.26082005, 1.47656041],
    [0.13631823, 0.26066111, 1.47226885],
    [0.13100795, 0.26603737, 1.48208726],
    [0.12316414, 0.26565963, 1.47355875],
    [0.16342414, 0.25100558, 1.49464816],
    [0.14731315, 0.25194737, 1.47077673],
    [0.2143042, 0.24318282, 1.49111838],
    [0.20278328, 0.24368016, 1.46683009],
    [0.18996201, 0.26006567, 1.48315312],
    [0.19626825, 0.28218885, 1.45997171],
    [0.08518666, 0.19277449, 1.48970261],
    [0.07612358, 0.19132769, 1.48171681],
    [0.15006862, 0.10451987, 1.48851148],
    [0.14388192, 0.09876908, 1.47367482],
    [0.17576262, 0.09766281, 1.48750845],
    [0.16534316, 0.09316265, 1.47856422],
    [0.22544565, 0.09667926, 1.48961743],
    [0.22597619, 0.09323285, 1.49535533],
    [0.18251031, 0.10700838, 1.49242406],
    [0.21561757, 0.0910011, 1.4742842],
    [0.21822992, 0.08889693, 1.47204053],
    [0.1673943, 0.1042803, 1.48374719],
    [0.18996201, 0.26006567, 1.48315312],
    [0.18453426, 0.26930769, 1.48194752],
    [0.18417595, 0.27572268, 1.48210105],
    [0.18706458, 0.282378, 1.48249416],
    [0.1903125, 0.29073736, 1.48261018],
    [0.19982201, 0.28179701, 1.48314634],
    [0.20419358, 0.28945438, 1.48402147],
    [0.20272988, 0.29231961, 1.48372148],
    [0.20227552, 0.29621846, 1.48359452],
    [0.20696103, 0.28334234, 1.48403074],
    [0.20848786, 0.28913791, 1.48410076],
    [0.20533303, 0.291275, 1.4838081],
    [0.20328722, 0.29483852, 1.4834028],
    [0.20911296, 0.28087336, 1.48451732],
    [0.20851357, 0.28564868, 1.48446826],
    [0.20540115, 0.28758341, 1.48381301],
    [0.20298579, 0.29000368, 1.48318272],
    [0.20969747, 0.27849736, 1.48480124],
    [0.20878653, 0.28113395, 1.4846279],
    [0.20663114, 0.28296474, 1.48426635],
    [0.20503783, 0.28518137, 1.48416992],
    [0.19626825, 0.28218885, 1.45997171],
    [0.19374385, 0.29432325, 1.45898177],
    [0.19534344, 0.30225467, 1.4586014],
    [0.19980963, 0.31079035, 1.45852928],
    [0.20386188, 0.32051634, 1.45819608],
    [0.2127263, 0.31277607, 1.45979309],
    [0.21658233, 0.32328478, 1.45994505],
    [0.21284664, 0.3267893, 1.45969073],
    [0.21050179, 0.33122183, 1.45937423],
    [0.21815563, 0.31565717, 1.46045649],
    [0.21835445, 0.32449239, 1.46058878],
    [0.21363993, 0.32681484, 1.46013255],
    [0.21020839, 0.33002164, 1.45965576],
    [0.21741696, 0.31257274, 1.46082379],
    [0.21584279, 0.31945691, 1.46072987],
    [0.21116628, 0.3212517, 1.46039047],
    [0.20779253, 0.32307944, 1.45996332],
    [0.21545887, 0.30921037, 1.4610797],
    [0.21364449, 0.31282782, 1.46096839],
    [0.21044126, 0.31490845, 1.46081827],
    [0.20840567, 0.31755869, 1.46054336],
    [0.13030239, 0.2632065, 1.47228332],
    [0.12826166, 0.26134236, 1.4724773],
    [0.12518608, 0.26019626, 1.47256908],
    [0.1216015, 0.25913401, 1.47250282],
    [0.11897376, 0.25752061, 1.47224282],
    [0.11662204, 0.25581495, 1.47219256],
    [0.115494, 0.25381015, 1.47245158],
    [0.11685632, 0.25184752, 1.47304068],
    [0.1174078, 0.25159444, 1.47411289],
    [0.11769184, 0.25196918, 1.47520708],
    [0.11743516, 0.25344498, 1.47662788],
    [0.11972951, 0.25555078, 1.47778681],
    [0.12273416, 0.25743734, 1.47860741],
    [0.1255143, 0.25956948, 1.47893828],
    [0.12890721, 0.26096955, 1.4789712],
    [0.13220967, 0.2624456, 1.47913234],
    [0.13479409, 0.26424185, 1.4793845],
    [0.13437208, 0.26154866, 1.47141849],
    [0.13952604, 0.26125641, 1.47144613],
    [0.1419199, 0.26032689, 1.47193795],
    [0.14244403, 0.25959333, 1.47268148],
    [0.14179614, 0.25932737, 1.47339403],
    [0.14218425, 0.25935166, 1.47454742],
    [0.14343376, 0.25970161, 1.47545537],
    [0.14377764, 0.26031176, 1.47661682],
    [0.14240474, 0.26117818, 1.47786148],
    [0.13819642, 0.2615443, 1.4788244],
    [0.13990079, 0.25854622, 1.47388348],
    [0.14048468, 0.25734792, 1.47374639],
    [0.14131081, 0.25626556, 1.47367002],
    [0.14194021, 0.25512131, 1.47358535],
    [0.13255286, 0.25585704, 1.47304832],
    [0.13327941, 0.25550767, 1.47333098],
    [0.13360163, 0.25523654, 1.47369835],
    [0.13363215, 0.25547118, 1.47413997],
    [0.13319382, 0.25580837, 1.4745896],
    [0.13453364, 0.26008373, 1.4718339],
    [0.13673472, 0.25952967, 1.47209302],
    [0.13597283, 0.25955746, 1.47258908],
    [0.13386324, 0.2594874, 1.47307705],
    [0.13432508, 0.25927725, 1.47262107],
    [0.1348522, 0.25935142, 1.47215291],
    [0.13489262, 0.25951571, 1.47532875],
    [0.13743883, 0.2595995, 1.47585491],
    [0.13874381, 0.25968375, 1.4765578],
    [0.13725428, 0.26024637, 1.47735962],
    [0.13684793, 0.25951472, 1.47652933],
    [0.13578054, 0.25938122, 1.47584434],
    [0.12521634, 0.25483581, 1.4725049],
    [0.12896965, 0.25441758, 1.47275571],
    [0.13088256, 0.25417305, 1.47328852],
    [0.13107647, 0.25410653, 1.47366704],
    [0.13121866, 0.25421331, 1.47408787],
    [0.12989303, 0.25446109, 1.4748282],
    [0.12674724, 0.25479718, 1.47550165],
    [0.12718822, 0.25389348, 1.47493051],
    [0.12786137, 0.25326447, 1.47416081],
    [0.12773793, 0.25323247, 1.47371912],
    [0.12752029, 0.25328425, 1.47329711],
    [0.12627624, 0.25381, 1.47276233],
    [0.12503266, 0.25489661, 1.47256724],
    [0.12813245, 0.25425654, 1.47338574],
    [0.12838482, 0.25422424, 1.47376606],
    [0.12852804, 0.25426217, 1.47416948],
    [0.12670796, 0.25481024, 1.4754894],
    [0.12788585, 0.25396886, 1.47423744],
    [0.12782932, 0.25391605, 1.47378416],
    [0.12753491, 0.25403469, 1.47336919],
]
# 2D keypoint normalization parameters
# From file: '{data_root}/annotation_body3d/fps50/joint2d_stats.pkl'
keypoints_mean = [
    [1915.96033968, 1287.85153668],
    [1912.3170367, 1251.67585396],
    [1920.11605967, 1251.15249657],
    [1909.30977142, 1257.92150663],
    [1926.64221496, 1263.05747514],
    [1899.37948047, 1429.33756999],
    [1939.74947619, 1427.03585751],
    [1888.85513463, 1636.24157657],
    [1948.02409853, 1625.36969795],
    [1893.5811598, 1713.18697405],
    [1930.01072576, 1679.92588139],
    [1911.92533075, 1865.44836021],
    [1926.27198053, 1869.23707879],
    [1895.1365319, 2122.58357214],
    [1927.38095591, 2118.12363553],
    [1901.35496818, 2445.08148785],
    [1921.50773649, 2449.54185469],
    [1888.42604741, 2510.07472593],
    [1885.11548846, 2513.58033052],
    [1904.48483205, 2469.28146861],
    [1914.1974283, 2511.66133726],
    [1924.9883474, 2513.76248522],
    [1922.02470458, 2484.96556074],
    [1893.5811598, 1713.18697405],
    [1896.92590033, 1714.13171423],
    [1898.66183792, 1717.86574796],
    [1900.05971277, 1720.57100575],
    [1902.0332616, 1725.05035072],
    [1897.57144635, 1721.17394609],
    [1899.11982514, 1728.22865099],
    [1899.67805211, 1732.60141553],
    [1899.85636696, 1735.70382549],
    [1896.77017885, 1729.14932724],
    [1898.22143989, 1735.98270984],
    [1898.57866135, 1738.76702071],
    [1898.53215357, 1740.21601817],
    [1895.82152403, 1736.06898852],
    [1897.17484544, 1740.74234918],
    [1897.47451173, 1742.57443843],
    [1897.41716131, 1742.60288896],
    [1895.27003833, 1741.16383983],
    [1896.01543962, 1743.85035531],
    [1896.3706819, 1745.50752125],
    [1896.20139712, 1746.32571376],
    [1930.01072576, 1679.92588139],
    [1927.13911625, 1674.91382891],
    [1925.59831813, 1675.55297492],
    [1924.61445785, 1675.61976416],
    [1923.19742057, 1676.95332616],
    [1925.74992264, 1680.06334318],
    [1924.45704252, 1684.45174972],
    [1923.42518642, 1686.86864546],
    [1922.19056659, 1687.95887677],
    [1925.64392861, 1689.35119304],
    [1924.32259946, 1694.34990686],
    [1923.19256109, 1695.90767287],
    [1922.09743337, 1696.00797933],
    [1925.84114437, 1698.07662615],
    [1924.41942343, 1701.3489017],
    [1923.16393333, 1702.42745262],
    [1922.22382187, 1701.54560998],
    [1925.92303728, 1704.34614571],
    [1924.74646036, 1706.40498034],
    [1923.70244408, 1707.60381835],
    [1922.77902537, 1707.59374545],
    [1925.55015154, 1249.71989231],
    [1925.39818747, 1265.30171349],
    [1925.13333164, 1280.62030564],
    [1925.17118514, 1294.95458827],
    [1924.55399428, 1309.30916235],
    [1923.30034822, 1322.23884955],
    [1921.52668418, 1333.55272044],
    [1919.14769363, 1342.55232333],
    [1917.02337632, 1345.31837273],
    [1915.03769623, 1342.81537208],
    [1913.24890439, 1333.772816],
    [1911.87750491, 1322.09689156],
    [1910.90181043, 1308.81349827],
    [1910.57155083, 1294.3553695],
    [1910.06930161, 1279.78192902],
    [1909.69599799, 1264.56761273],
    [1909.1310133, 1249.39425237],
    [1924.05026102, 1245.64913683],
    [1922.69760163, 1234.81532682],
    [1920.70832061, 1233.84629425],
    [1918.75876132, 1236.30101501],
    [1917.16108506, 1240.08400716],
    [1915.03320082, 1240.02345412],
    [1913.47564784, 1236.09825118],
    [1911.7125946, 1233.48811575],
    [1910.24783714, 1234.81581335],
    [1909.5893345, 1245.70114142],
    [1916.13304473, 1252.65003796],
    [1916.05469238, 1262.90470073],
    [1915.96358413, 1272.03464437],
    [1915.87858309, 1281.38489189],
    [1917.79823927, 1287.61796766],
    [1917.06918707, 1290.19801541],
    [1916.26509821, 1292.18244619],
    [1915.4997418, 1290.1657551],
    [1914.85961909, 1287.55481541],
    [1922.00473442, 1252.50799351],
    [1920.77581795, 1249.72679122],
    [1919.578637, 1250.04003838],
    [1918.6757405, 1254.15974836],
    [1919.57203371, 1256.30412504],
    [1920.7417985, 1256.49606123],
    [1914.30872318, 1253.98519169],
    [1913.27940786, 1249.82043345],
    [1912.11779285, 1249.3971234],
    [1911.2032987, 1252.09092061],
    [1912.22255674, 1256.22937256],
    [1913.37265449, 1256.04687169],
    [1919.60916051, 1307.23449636],
    [1918.44029955, 1303.67097011],
    [1917.11669378, 1302.62113716],
    [1916.34998788, 1303.2746219],
    [1915.57424191, 1302.56749089],
    [1914.4854304, 1303.43467219],
    [1913.85061052, 1307.17467225],
    [1914.55461769, 1312.61737411],
    [1915.72000361, 1315.23818954],
    [1916.55453496, 1315.65917714],
    [1917.38050402, 1315.31714443],
    [1918.72107986, 1312.71258965],
    [1919.5395914, 1307.17943257],
    [1917.2417983, 1306.57444779],
    [1916.46195414, 1306.72714004],
    [1915.71666656, 1306.47969139],
    [1913.8781433, 1307.11629633],
    [1915.71074895, 1309.34114759],
    [1916.54010248, 1309.35121947],
    [1917.40660095, 1309.33720993],
]
keypoints_std = [
    [119.69150809, 214.98755177],
    [115.90012886, 217.21429731],
    [115.36375663, 217.26616787],
    [107.17981668, 220.08048648],
    [101.61050327, 220.86469637],
    [138.46299536, 221.3609881],
    [124.12770583, 220.72269894],
    [184.89776253, 240.37516009],
    [175.57685792, 240.14617929],
    [161.77657018, 265.63030158],
    [168.24527424, 279.38523912],
    [79.04934698, 248.05543697],
    [69.81004009, 246.91099717],
    [131.74873788, 265.7097062],
    [123.38064227, 261.60265835],
    [149.20053538, 343.18196051],
    [136.22413093, 346.34085277],
    [196.42050411, 359.00197648],
    [195.99307895, 361.92147014],
    [155.26980607, 353.62488719],
    [179.8351339, 359.3629365],
    [181.01587271, 358.77175916],
    [139.50966702, 359.39824762],
    [161.77657018, 265.63030158],
    [157.69085831, 272.41132254],
    [157.84899175, 277.44033865],
    [160.77075036, 282.77922046],
    [164.09592818, 289.24805425],
    [171.47265362, 282.99144327],
    [175.74877367, 289.60210266],
    [174.57728331, 292.57735934],
    [174.320036, 296.3561516],
    [177.37926538, 285.6852192],
    [178.89537236, 291.23280014],
    [175.94011281, 293.82471626],
    [174.02700118, 297.50015815],
    [178.69441331, 285.20996935],
    [178.33985066, 289.75457106],
    [175.47330417, 291.97834877],
    [173.27355648, 294.20715346],
    [178.75461232, 284.46749202],
    [178.10963676, 287.13572393],
    [176.22610693, 289.1033994],
    [174.77867367, 291.39160506],
    [168.24527424, 279.38523912],
    [166.30891981, 286.86611783],
    [167.93982754, 293.15377477],
    [171.89828917, 299.65607896],
    [175.5990076, 307.98903401],
    [183.00509145, 301.43904174],
    [186.81002516, 309.99611963],
    [183.56055745, 313.26187435],
    [181.57074524, 316.76798199],
    [187.77415473, 305.60572552],
    [188.3756795, 313.08612604],
    [184.25960956, 314.89982488],
    [181.32131872, 316.75922258],
    [187.17467227, 305.22868324],
    [186.11698091, 311.06796881],
    [182.2465884, 312.16137832],
    [179.44753407, 312.50032092],
    [185.55667673, 304.12249441],
    [184.22041915, 307.12654143],
    [181.72518947, 308.38370219],
    [180.16928885, 309.56933487],
    [109.04880232, 218.65267015],
    [107.63158956, 218.15185867],
    [105.01369039, 218.04054739],
    [101.8906412, 217.9528267],
    [99.73099221, 217.58166581],
    [97.81488671, 217.05820386],
    [97.11622677, 216.2662806],
    [98.75921263, 215.44112619],
    [99.21919242, 215.40594376],
    [99.12229001, 215.31908906],
    [98.11572436, 215.46038821],
    [99.47892481, 216.05588775],
    [101.55080987, 216.53485389],
    [103.52437289, 217.23984417],
    [106.31855758, 217.56689231],
    [109.08477906, 218.06533038],
    [111.01883611, 218.62266723],
    [113.15242593, 217.68741641],
    [118.05180899, 217.2351513],
    [120.44844233, 216.56391825],
    [120.99223132, 216.11011609],
    [120.33819737, 216.0165106],
    [120.4196293, 215.9242813],
    [121.2642599, 215.93697679],
    [121.13172284, 216.09409905],
    [119.32534556, 216.52902226],
    [115.11098627, 216.94093595],
    [118.71056537, 215.91280782],
    [119.58604732, 215.57226762],
    [120.6726078, 215.28886761],
    [121.55171991, 214.98541354],
    [112.65890517, 215.52949879],
    [113.38517266, 215.44124902],
    [113.68077309, 215.32419724],
    [113.5537337, 215.3173311],
    [112.94359166, 215.32198737],
    [113.65541259, 216.96528552],
    [115.76701348, 216.48984631],
    [114.9918512, 216.4759035],
    [112.97852552, 216.51695075],
    [113.56236114, 216.51929872],
    [114.12382522, 216.63949661],
    [113.40636586, 216.2959772],
    [115.60219521, 216.17208311],
    [116.62999386, 216.15358534],
    [114.94215451, 216.52195421],
    [114.97146772, 216.32490518],
    [114.16782746, 216.27431516],
    [106.07620451, 215.64936454],
    [109.67489424, 215.27034433],
    [111.43585325, 215.06779617],
    [111.56293941, 215.02172311],
    [111.57653605, 215.00869732],
    [110.09900575, 215.06787023],
    [106.89679481, 215.27642405],
    [107.65595036, 215.01266852],
    [108.5993822, 214.83444182],
    [108.5948973, 214.89538564],
    [108.45188458, 214.96372861],
    [107.23726244, 215.19392775],
    [105.88926785, 215.68298639],
    [108.84100179, 215.2699435],
    [109.00515169, 215.21522668],
    [109.03740132, 215.17515951],
    [106.86229784, 215.28475207],
    [108.45024653, 214.96945794],
    [108.50698508, 214.98956708],
    [108.29823673, 215.13675125],
]

codec = dict(
    type='ImagePoseLifting',
    num_keypoints=133,
    root_index=0,
    remove_root=False,
    target_mean=target_mean,
    target_std=target_std,
    keypoints_mean=keypoints_mean,
    keypoints_std=keypoints_std)

# model settings
model = dict(
    type='PoseLifter',
    backbone=dict(
        type='TCN',
        in_channels=2 * 133,
        stem_channels=1024,
        num_blocks=2,
        kernel_sizes=(1, 1, 1),
        dropout=0.5,
    ),
    head=dict(
        type='TemporalRegressionHead',
        in_channels=1024,
        num_joints=133,
        loss=dict(type='MSELoss'),
        decoder=codec,
    ))

# base dataset settings
dataset_type = 'AgoraDataset'
data_root = 'data/agora/'

# pipelines
train_pipeline = [
    dict(type='GenerateTarget', encoder=codec),
    dict(
        type='PackPoseInputs',
        meta_keys=('id', 'category_id', 'target_img_path', 'flip_indices',
                   'target_root', 'target_root_index', 'target_mean',
                   'target_std'))
]
val_pipeline = train_pipeline

# data loaders
train_dataloader = dict(
    batch_size=512,
    num_workers=2,
    persistent_workers=True,
    sampler=dict(type='DefaultSampler', shuffle=True),
    dataset=dict(
        type=dataset_type,
        ann_file='agora_train_annotation.json',
        seq_len=1,
        causal=True,
        keypoint_2d_src='gt',
        data_root=data_root,
        data_prefix=dict(img='images/'),
        pipeline=train_pipeline,
    ))
val_dataloader = dict(
    batch_size=512,
    num_workers=2,
    persistent_workers=True,
    drop_last=False,
    sampler=dict(type='DefaultSampler', shuffle=False, round_up=False),
    dataset=dict(
        type=dataset_type,
        ann_file='agora_train_annotation.json',
        seq_len=1,
        causal=True,
        keypoint_2d_src='gt',
        data_root=data_root,
        data_prefix=dict(img='images/'),
        pipeline=train_pipeline,
    ))
test_dataloader = val_dataloader

# evaluators
val_evaluator = [
    dict(type='MPJPE', mode='mpjpe'),
    dict(type='MPJPE', mode='p-mpjpe')
]
test_evaluator = val_evaluator
