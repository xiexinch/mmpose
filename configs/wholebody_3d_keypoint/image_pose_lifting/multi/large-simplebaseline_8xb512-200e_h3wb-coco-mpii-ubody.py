_base_ = ['../../../_base_/default_runtime.py']

vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    type='Pose3dLocalVisualizer', vis_backends=vis_backends, name='visualizer')

# runtime
train_cfg = dict(max_epochs=210, val_interval=10)

# optimizer
optim_wrapper = dict(optimizer=dict(
    type='Adam',
    lr=5e-4,
))

# learning policy
param_scheduler = [
    dict(
        type='LinearLR', begin=0, end=500, start_factor=0.001,
        by_epoch=False),  # warm-up
    dict(
        type='MultiStepLR',
        begin=0,
        end=200,
        milestones=[170, 200],
        gamma=0.1,
        by_epoch=True)
]

auto_scale_lr = dict(base_batch_size=512)

# hooks
default_hooks = dict(
    checkpoint=dict(
        type='CheckpointHook',
        save_best='MPJPE',
        rule='less',
        max_keep_ckpts=1))

# codec settings
# 3D keypoint normalization parameters
target_mean = [
    [0.009645957499742508, -0.34591203927993774, 22.584491729736328],
    [0.0334501713514328, -0.3860214352607727, 22.603256225585938],
    [-0.01180566381663084, -0.3848191499710083, 22.604612350463867],
    [0.05933380872011185, -0.3776020407676697, 22.66649627685547],
    [-0.03680374473333359, -0.3715055286884308, 22.671144485473633],
    [0.11950266361236572, -0.1972222775220871, 22.691370010375977],
    [-0.09177315980195999, -0.1960882842540741, 22.696996688842773],
    [0.17270272970199585, 0.016827715560793877, 22.682924270629883],
    [-0.15399202704429626, 0.008103900589048862, 22.653459548950195],
    [0.12959444522857666, 0.01735059544444084, 22.550373077392578],
    [-0.105481818318367, -0.0032386237289756536, 22.525875091552734],
    [0.05067315697669983, 0.28134140372276306, 22.720842361450195],
    [-0.035803694278001785, 0.28940460085868835, 22.71589469909668],
    [0.11414993554353714, 0.5890116691589355, 22.634658813476562],
    [-0.0919286385178566, 0.587030827999115, 22.635286331176758],
    [0.08502619713544846, 0.9610114097595215, 22.700166702270508],
    [-0.08356188237667084, 0.9660475254058838, 22.692405700683594],
    [0.1142299473285675, 1.0118770599365234, 22.57180404663086],
    [0.15600959956645966, 1.0196717977523804, 22.611669540405273],
    [0.09484341740608215, 0.9997246265411377, 22.74614906311035],
    [-0.09297772496938705, 1.0165427923202515, 22.568923950195312],
    [-0.1418691724538803, 1.0243022441864014, 22.606889724731445],
    [-0.08182311803102493, 1.01671302318573, 22.742938995361328],
    [0.13010355830192566, -0.0261482335627079, 22.540674209594727],
    [0.11391205340623856, -0.036926280707120895, 22.529722213745117],
    [0.10417436063289642, -0.03958940878510475, 22.523527145385742],
    [0.0977388396859169, -0.04137403890490532, 22.515018463134766],
    [0.08897332847118378, -0.038142893463373184, 22.505577087402344],
    [0.1106133759021759, -0.041721634566783905, 22.503847122192383],
    [0.10249403864145279, -0.04012016952037811, 22.493986129760742],
    [0.09572049230337143, -0.033475112169981, 22.49365234375],
    [0.08792436867952347, -0.028122765943408012, 22.49444580078125],
    [0.1142876073718071, -0.03210154548287392, 22.497081756591797],
    [0.10511559247970581, -0.028953472152352333, 22.489595413208008],
    [0.09806705266237259, -0.02370036579668522, 22.490482330322266],
    [0.09089536964893341, -0.019141996279358864, 22.49295997619629],
    [0.11850299686193466, -0.024563616141676903, 22.49730682373047],
    [0.10922843962907791, -0.023539867252111435, 22.490978240966797],
    [0.10178212821483612, -0.019595934078097343, 22.492277145385742],
    [0.0951620414853096, -0.017621805891394615, 22.49512481689453],
    [0.12084473669528961, -0.0189853273332119, 22.499691009521484],
    [0.11501847952604294, -0.01664656214416027, 22.49608612060547],
    [0.10874349623918533, -0.012881698086857796, 22.497074127197266],
    [0.10264419764280319, -0.010561694391071796, 22.499271392822266],
    [-0.1049165427684784, -0.043593935668468475, 22.516719818115234],
    [-0.08686193823814392, -0.056702110916376114, 22.508373260498047],
    [-0.0764220654964447, -0.061994291841983795, 22.501985549926758],
    [-0.06951528042554855, -0.06639941781759262, 22.493715286254883],
    [-0.059452056884765625, -0.0662199929356575, 22.485034942626953],
    [-0.08340854197740555, -0.07078757137060165, 22.482633590698242],
    [-0.0747576355934143, -0.06984429061412811, 22.472698211669922],
    [-0.06763389706611633, -0.06290124356746674, 22.472274780273438],
    [-0.059895627200603485, -0.05658122897148132, 22.472408294677734],
    [-0.0875401571393013, -0.05904557555913925, 22.475933074951172],
    [-0.0778316780924797, -0.05455797538161278, 22.469308853149414],
    [-0.07062316685914993, -0.04800821468234062, 22.470720291137695],
    [-0.06374198943376541, -0.04124482348561287, 22.473735809326172],
    [-0.09211762249469757, -0.045077770948410034, 22.47673988342285],
    [-0.08239178359508514, -0.04359596222639084, 22.47096061706543],
    [-0.0748419463634491, -0.041237540543079376, 22.472108840942383],
    [-0.06848232448101044, -0.037441935390233994, 22.475683212280273],
    [-0.0946769118309021, -0.03802308440208435, 22.47818946838379],
    [-0.08858011662960052, -0.035453539341688156, 22.475101470947266],
    [-0.08217868208885193, -0.03124544396996498, 22.47659683227539],
    [-0.07625638693571091, -0.02860620804131031, 22.4791259765625],
    [-0.042540665715932846, -0.3869868516921997, 22.640525817871094],
    [-0.04307939112186432, -0.3706427216529846, 22.636741638183594],
    [-0.042062025517225266, -0.3540011942386627, 22.638296127319336],
    [-0.03943369910120964, -0.3383353352546692, 22.6405086517334],
    [-0.03395502269268036, -0.32296499609947205, 22.637977600097656],
    [-0.025568991899490356, -0.3084369897842407, 22.634719848632812],
    [-0.014223730191588402, -0.28997865319252014, 22.630014419555664],
    [-0.0016471997369080782, -0.2816409468650818, 22.619462966918945],
    [0.010297671891748905, -0.2792660892009735, 22.616504669189453],
    [0.023007620126008987, -0.2823592722415924, 22.61910629272461],
    [0.035109106451272964, -0.29105889797210693, 22.62871551513672],
    [0.04659177362918854, -0.30378010869026184, 22.634532928466797],
    [0.055386532098054886, -0.31784895062446594, 22.638376235961914],
    [0.06094317138195038, -0.3325697183609009, 22.641399383544922],
    [0.06366407871246338, -0.3480018079280853, 22.639617919921875],
    [0.06455770879983902, -0.36415934562683105, 22.638124465942383],
    [0.06373093277215958, -0.381075918674469, 22.64105987548828],
    [-0.031211338937282562, -0.38627946376800537, 22.623899459838867],
    [-0.025275731459259987, -0.39646822214126587, 22.61111831665039],
    [-0.015153184533119202, -0.39716532826423645, 22.60110092163086],
    [-0.0049432008527219296, -0.3953215777873993, 22.596227645874023],
    [0.003693753620609641, -0.3919714689254761, 22.595073699951172],
    [0.015997476875782013, -0.39192697405815125, 22.594776153564453],
    [0.024582425132393837, -0.39535391330718994, 22.595420837402344],
    [0.03503446280956268, -0.39762476086616516, 22.599443435668945],
    [0.045379817485809326, -0.3972586393356323, 22.60904312133789],
    [0.0512860082089901, -0.3492547273635864, 22.629653930664062],
    [0.009438018314540386, -0.34054145216941833, 22.603673934936523],
    [0.009253759868443012, -0.3303625285625458, 22.60000228881836],
    [0.009097053669393063, -0.3196689784526825, 22.59604835510254],
    [0.009059930220246315, -0.30880439281463623, 22.592554092407227],
    [0.0009048312203958631, -0.30286455154418945, 22.608064651489258],
    [0.004951443988829851, -0.2993943691253662, 22.6060848236084],
    [0.009301208890974522, -0.29685360193252563, 22.60492706298828],
    [0.013804533518850803, -0.29836487770080566, 22.60602569580078],
    [0.017944814637303352, -0.30251386761665344, 22.607746124267578],
    [-0.02084307372570038, -0.3380504250526428, 22.622169494628906],
    [-0.015283116139471531, -0.3402766287326813, 22.61557960510254],
    [-0.008532295934855938, -0.33957916498184204, 22.614973068237305],
    [-0.0027684711385518312, -0.33710619807243347, 22.616605758666992],
    [-0.00841123703867197, -0.333554208278656, 22.61635398864746],
    [-0.014409918338060379, -0.3327740430831909, 22.617286682128906],
    [0.02194594033062458, -0.3353659212589264, 22.616262435913086],
    [0.027415482327342033, -0.3406430780887604, 22.61371421813965],
    [0.03426773101091385, -0.34047919511795044, 22.613924026489258],
    [0.04010404273867607, -0.33738672733306885, 22.620542526245117],
    [0.03343604505062103, -0.33278173208236694, 22.61591911315918],
    [0.027385292574763298, -0.3425646424293518, 22.613399505615234],
    [-0.0064346930012106895, -0.28602173924446106, 22.61725616455078],
    [-0.0017693236004561186, -0.29150599241256714, 22.60908317565918],
    [0.005152987316250801, -0.29273977875709534, 22.60539436340332],
    [0.009304207749664783, -0.2914280295372009, 22.60504722595215],
    [0.01347278617322445, -0.2928101122379303, 22.605146408081055],
    [0.020576372742652893, -0.2906971573829651, 22.609071731567383],
    [0.025897452607750893, -0.2852403223514557, 22.616613388061523],
    [0.021030433475971222, -0.27876922488212585, 22.61297035217285],
    [0.014243683777749538, -0.27750256657600403, 22.609180450439453],
    [0.009531904011964798, -0.27576732635498047, 22.60902214050293],
    [0.004855244420468807, -0.27557995915412903, 22.609758377075195],
    [-0.0017083913553506136, -0.2775125801563263, 22.61372947692871],
    [-0.005953836254775524, -0.28462108969688416, 22.617979049682617],
    [0.005236731376498938, -0.2859768271446228, 22.61011505126953],
    [0.009409626945853233, -0.28554803133010864, 22.609403610229492],
    [0.013557576574385166, -0.285275936126709, 22.610074996948242],
    [0.02571932040154934, -0.28462421894073486, 22.6168155670166],
    [0.01401690486818552, -0.28117531538009644, 22.610973358154297],
    [0.009487428702414036, -0.2807753086090088, 22.61064338684082],
    [0.004959207493811846, -0.2802022397518158, 22.61145782470703]
]

target_std = [[0.17909060418605804, 0.30226340889930725, 10.995611190795898],
              [0.1759183257818222, 0.29989323019981384, 10.996240615844727],
              [0.18300573527812958, 0.29953595995903015, 10.995857238769531],
              [0.17130862176418304, 0.30097874999046326, 10.995821952819824],
              [0.18665790557861328, 0.30145224928855896, 10.994987487792969],
              [0.17622938752174377, 0.2968462109565735, 10.994925498962402],
              [0.2057247906923294, 0.29701247811317444, 10.992737770080566],
              [0.19876742362976074, 0.3066040277481079, 11.006114959716797],
              [0.24397043883800507, 0.3065325915813446, 11.00511360168457],
              [0.21217620372772217, 0.2991408407688141, 11.014228820800781],
              [0.25241708755493164, 0.30986905097961426, 11.012716293334961],
              [0.16127005219459534, 0.3150483965873718, 10.991698265075684],
              [0.18187062442302704, 0.31700173020362854, 10.991827011108398],
              [0.18211856484413147, 0.33012720942497253, 10.992795944213867],
              [0.20492398738861084, 0.3295133113861084, 10.992350578308105],
              [0.19883570075035095, 0.35291752219200134, 11.001441955566406],
              [0.22227683663368225, 0.3537141978740692, 11.004117012023926],
              [0.21785135567188263, 0.35723525285720825, 11.004581451416016],
              [0.22404444217681885, 0.3580307960510254, 11.003397941589355],
              [0.20586127042770386, 0.3564174175262451, 11.001171112060547],
              [0.2378075271844864, 0.3549453616142273, 11.008306503295898],
              [0.2536218464374542, 0.3569813668727875, 11.007303237915039],
              [0.22632594406604767, 0.3612462282180786, 11.004670143127441],
              [0.21879133582115173, 0.39455071091651917, 11.029853820800781],
              [0.22002117335796356, 0.3895101249217987, 11.029133796691895],
              [0.2219696342945099, 0.38721510767936707, 11.028855323791504],
              [0.22591468691825867, 0.3849192261695862, 11.029067039489746],
              [0.23071593046188354, 0.3861657977104187, 11.029993057250977],
              [0.23125231266021729, 0.3785303235054016, 11.029472351074219],
              [0.236541286110878, 0.3799484074115753, 11.030571937561035],
              [0.23659959435462952, 0.3818148374557495, 11.031122207641602],
              [0.23661459982395172, 0.3851144313812256, 11.03166675567627],
              [0.23221147060394287, 0.378211110830307, 11.030916213989258],
              [0.23627808690071106, 0.38545796275138855, 11.032613754272461],
              [0.23599575459957123, 0.3913327157497406, 11.033607482910156],
              [0.23545719683170319, 0.3983229398727417, 11.034468650817871],
              [0.23123310506343842, 0.3939193785190582, 11.034214973449707],
              [0.23504799604415894, 0.40121057629585266, 11.03571891784668],
              [0.2348126471042633, 0.4078527092933655, 11.036538124084473],
              [0.2337045818567276, 0.4141615629196167, 11.037144660949707],
              [0.23729030787944794, 0.4091862142086029, 11.0371732711792],
              [0.23923125863075256, 0.4134127199649811, 11.038065910339355],
              [0.23881004750728607, 0.4159349799156189, 11.038320541381836],
              [0.2372283637523651, 0.4170307219028473, 11.038094520568848],
              [0.22919829189777374, 0.396170049905777, 11.0267972946167],
              [0.2262324094772339, 0.39546000957489014, 11.026164054870605],
              [0.22639688849449158, 0.39717867970466614, 11.026427268981934],
              [0.22892391681671143, 0.398963063955307, 11.027039527893066],
              [0.23184697329998016, 0.40297746658325195, 11.028241157531738],
              [0.23711538314819336, 0.39841896295547485, 11.028008460998535],
              [0.24428516626358032, 0.39814189076423645, 11.02877426147461],
              [0.24420379102230072, 0.3991580009460449, 11.029404640197754],
              [0.2442549467086792, 0.4005102217197418, 11.02989673614502],
              [0.24486665427684784, 0.3912360966205597, 11.028463363647461],
              [0.2489970475435257, 0.39370453357696533, 11.02942180633545],
              [0.2477588802576065, 0.39669907093048096, 11.0299711227417],
              [0.24594879150390625, 0.3996504843235016, 11.030291557312012],
              [0.24622903764247894, 0.3922122120857239, 11.029768943786621],
              [0.2482219934463501, 0.3967758119106293, 11.030780792236328],
              [0.2500048279762268, 0.4074934720993042, 11.03233814239502],
              [0.24727673828601837, 0.40959441661834717, 11.03225040435791],
              [0.24850517511367798, 0.4046294689178467, 11.032349586486816],
              [0.24976679682731628, 0.4067833125591278, 11.033036231994629],
              [0.24924635887145996, 0.40817809104919434, 11.03307819366455],
              [0.24774540960788727, 0.40969911217689514, 11.032991409301758],
              [0.1815103143453598, 0.2995603680610657, 10.994184494018555],
              [0.18011225759983063, 0.3042554259300232, 10.99471664428711],
              [0.17844349145889282, 0.3078703284263611, 10.995058059692383],
              [0.1768803745508194, 0.31129348278045654, 10.994637489318848],
              [0.17589987814426422, 0.3145107328891754, 10.994951248168945],
              [0.174874410033226, 0.3177335560321808, 10.995392799377441],
              [0.17604322731494904, 0.30838140845298767, 10.994192123413086],
              [0.17408964037895203, 0.3109379708766937, 10.994842529296875],
              [0.17241057753562927, 0.31205570697784424, 10.995466232299805],
              [0.17138998210430145, 0.3113348186016083, 10.99506664276123],
              [0.17073266208171844, 0.30907008051872253, 10.994606018066406],
              [0.1702651083469391, 0.3056720793247223, 10.99396800994873],
              [0.17001648247241974, 0.30207374691963196, 10.993391036987305],
              [0.1712346225976944, 0.2978162467479706, 10.992719650268555],
              [0.17251840233802795, 0.29346829652786255, 10.992724418640137],
              [0.17422771453857422, 0.2894535958766937, 10.99223804473877],
              [0.17582407593727112, 0.28581324219703674, 10.992085456848145],
              [0.18361392617225647, 0.28574904799461365, 10.993195533752441],
              [0.1847323328256607, 0.2841759920120239, 10.993339538574219],
              [0.18346336483955383, 0.28408560156822205, 10.99349594116211],
              [0.1820453554391861, 0.28470879793167114, 10.993736267089844],
              [0.18021228909492493, 0.28557324409484863, 10.993882179260254],
              [0.1787724643945694, 0.2852836549282074, 10.993900299072266],
              [0.1790679693222046, 0.2841475009918213, 10.99381160736084],
              [0.17945823073387146, 0.28348010778427124, 10.993807792663574],
              [0.17920397222042084, 0.2836107015609741, 10.993916511535645],
              [0.17645157873630524, 0.2336823046207428, 10.980236053466797],
              [0.17933666706085205, 0.2349224090576172, 10.980096817016602],
              [0.17966046929359436, 0.23679478466510773, 10.980225563049316],
              [0.18057391047477722, 0.23847146332263947, 10.980203628540039],
              [0.18143126368522644, 0.239709734916687, 10.980067253112793],
              [0.17946581542491913, 0.24049197137355804, 10.980307579040527],
              [0.18022947013378143, 0.24089846014976501, 10.9800443649292],
              [0.18049931526184082, 0.24090462923049927, 10.979866981506348],
              [0.18059834837913513, 0.2408168762922287, 10.979665756225586],
              [0.17876103520393372, 0.23966006934642792, 10.98006534576416],
              [0.1840028315782547, 0.23666086792945862, 10.978975296020508],
              [0.18446768820285797, 0.23629511892795563, 10.97879409790039],
              [0.18397554755210876, 0.23645398020744324, 10.978799819946289],
              [0.1813662201166153, 0.2354935109615326, 10.979288101196289],
              [0.18270018696784973, 0.23582713305950165, 10.978902816772461],
              [0.18374717235565186, 0.23588712513446808, 10.97865104675293],
              [0.18124477565288544, 0.23565815389156342, 10.978629112243652],
              [0.18021467328071594, 0.23406566679477692, 10.979052543640137],
              [0.18076030910015106, 0.2342204749584198, 10.978896141052246],
              [0.18025952577590942, 0.23465801775455475, 10.97883415222168],
              [0.1805959790945053, 0.23489098250865936, 10.978677749633789],
              [0.208268404006958, 0.24270014464855194, 10.98239803314209],
              [0.2065878063440323, 0.25156527757644653, 10.983406066894531],
              [0.20672139525413513, 0.2517045736312866, 10.983438491821289],
              [0.2068563997745514, 0.25215381383895874, 10.983329772949219],
              [0.20691749453544617, 0.25261858105659485, 10.983156204223633],
              [0.209177166223526, 0.2525174021720886, 10.983430862426758],
              [0.20866170525550842, 0.25328055024147034, 10.98319149017334],
              [0.20747491717338562, 0.25420552492141724, 10.983063697814941],
              [0.20721031725406647, 0.2552676200866699, 10.982977867126465],
              [0.20897911489009857, 0.25447943806648254, 10.983404159545898],
              [0.20927868783473969, 0.25481969118118286, 10.98304557800293],
              [0.20908816158771515, 0.25458985567092896, 10.982829093933105],
              [0.20872429013252258, 0.25442883372306824, 10.982711791992188],
              [0.21046984195709229, 0.25226029753685, 10.982995986938477],
              [0.21028809249401093, 0.251380056142807, 10.982685089111328],
              [0.20963770151138306, 0.2511281371116638, 10.982479095458984],
              [0.20892806351184845, 0.25107836723327637, 10.982373237609863],
              [0.20904755592346191, 0.25052595138549805, 10.982738494873047],
              [0.20978744328022003, 0.25129395723342896, 10.98254680633545],
              [0.2096181958913803, 0.2513124942779541, 10.982428550720215],
              [0.2095767855644226, 0.251293808221817, 10.98229694366455]]

# 2D keypoint normalization parameters
keypoints_mean = [[555.0411376953125, 241.9730224609375],
                  [577.611328125, 209.90786743164062],
                  [534.2891845703125, 210.96359252929688],
                  [602.272216796875, 216.92919921875],
                  [510.2938537597656, 222.28526306152344],
                  [657.0709228515625, 347.94580078125],
                  [460.1029052734375, 348.7453918457031],
                  [716.9552001953125, 510.97515869140625],
                  [390.430419921875, 500.1279296875],
                  [680.8699951171875, 491.42218017578125],
                  [432.1466064453125, 472.3580322265625],
                  [593.9390869140625, 732.9583129882812],
                  [510.9039001464844, 740.1028442382812],
                  [656.5266723632812, 983.0777587890625],
                  [456.4056396484375, 981.73583984375],
                  [628.3617553710938, 1270.4052734375],
                  [463.9470520019531, 1276.4168701171875],
                  [659.1378784179688, 1320.55078125],
                  [699.0033569335938, 1323.5791015625],
                  [637.14599609375, 1296.7071533203125],
                  [452.73675537109375, 1324.4654541015625],
                  [405.6982727050781, 1328.222412109375],
                  [466.4405822753906, 1313.3897705078125],
                  [680.762451171875, 480.91864013671875],
                  [664.271240234375, 468.2068176269531],
                  [654.3097534179688, 463.86053466796875],
                  [647.809814453125, 459.65191650390625],
                  [639.193115234375, 459.9429016113281],
                  [662.4597778320312, 455.5846862792969],
                  [654.8530883789062, 453.9721984863281],
                  [648.4000244140625, 459.0589599609375],
                  [640.6744995117188, 463.4835510253906],
                  [667.7069091796875, 461.7920837402344],
                  [659.6056518554688, 463.2607727050781],
                  [652.7188720703125, 468.6151428222656],
                  [645.45068359375, 473.7529602050781],
                  [673.075439453125, 472.13818359375],
                  [664.756591796875, 472.3365478515625],
                  [657.2883911132812, 476.9270935058594],
                  [650.1814575195312, 480.05584716796875],
                  [676.1132202148438, 481.0006408691406],
                  [671.1185302734375, 482.6087341308594],
                  [665.0210571289062, 485.9679870605469],
                  [658.6679077148438, 487.9395751953125],
                  [432.50811767578125, 462.60345458984375],
                  [450.5850830078125, 449.0331115722656],
                  [460.9125671386719, 443.3079528808594],
                  [467.6653747558594, 437.7977600097656],
                  [477.5573425292969, 436.26263427734375],
                  [452.57794189453125, 431.2912292480469],
                  [460.4793395996094, 428.3717956542969],
                  [467.114990234375, 433.26910400390625],
                  [474.5319519042969, 437.79766845703125],
                  [446.9169616699219, 437.0959167480469],
                  [455.3333740234375, 437.9115295410156],
                  [462.12518310546875, 443.2039794921875],
                  [468.890625, 448.956298828125],
                  [441.0996398925781, 448.76483154296875],
                  [449.629150390625, 448.12091064453125],
                  [456.78875732421875, 451.9797668457031],
                  [463.4075927734375, 455.5812072753906],
                  [437.61541748046875, 458.0186767578125],
                  [442.5732421875, 458.8955383300781],
                  [448.4918212890625, 462.105712890625],
                  [454.4224548339844, 464.4453430175781],
                  [506.3854064941406, 209.30943298339844],
                  [506.35784912109375, 223.41746520996094],
                  [507.6075134277344, 237.4306182861328],
                  [510.1714782714844, 250.58155822753906],
                  [515.02783203125, 263.3748779296875],
                  [522.4298095703125, 275.4872741699219],
                  [533.0625, 287.79486083984375],
                  [544.6417846679688, 294.88006591796875],
                  [556.1249389648438, 296.9690246582031],
                  [567.8897705078125, 294.25811767578125],
                  [578.9546508789062, 286.820068359375],
                  [589.5409545898438, 275.7862243652344],
                  [597.028564453125, 263.7227783203125],
                  [601.8385620117188, 251.07171630859375],
                  [604.4532470703125, 237.85044860839844],
                  [605.4490966796875, 223.98939514160156],
                  [604.90283203125, 209.66748046875],
                  [515.574951171875, 206.3968048095703],
                  [521.2976684570312, 197.90304565429688],
                  [530.9810791015625, 197.2651824951172],
                  [540.7478637695312, 198.7923126220703],
                  [549.0126953125, 201.57859802246094],
                  [560.9793090820312, 201.4762420654297],
                  [569.0988159179688, 198.4358673095703],
                  [579.10546875, 196.4284210205078],
                  [588.9725952148438, 196.66259765625],
                  [594.9943237304688, 214.1612548828125],
                  [555.1651611328125, 221.39520263671875],
                  [555.0252075195312, 229.7314910888672],
                  [554.9443969726562, 238.45620727539062],
                  [554.938232421875, 246.98634338378906],
                  [547.1209716796875, 252.9025115966797],
                  [551.0667114257812, 255.0701904296875],
                  [555.2770385742188, 256.6653747558594],
                  [559.5681762695312, 255.1554412841797],
                  [563.487548828125, 252.6831512451172],
                  [526.1384887695312, 222.3316192626953],
                  [531.5039672851562, 219.9603729248047],
                  [537.931396484375, 220.296142578125],
                  [543.4215698242188, 223.23362731933594],
                  [538.0860595703125, 225.53689575195312],
                  [532.390869140625, 225.92538452148438],
                  [567.157958984375, 223.33001708984375],
                  [572.2948608398438, 219.6407470703125],
                  [578.9271240234375, 219.2737274169922],
                  [584.5353393554688, 221.70590209960938],
                  [578.1395263671875, 225.33058166503906],
                  [571.9100341796875, 222.86073303222656],
                  [540.0192260742188, 270.9331970214844],
                  [544.3672485351562, 266.1842041015625],
                  [550.9872436523438, 264.775146484375],
                  [555.0098266601562, 265.4366455078125],
                  [558.9352416992188, 264.7320251464844],
                  [565.6821899414062, 266.1068115234375],
                  [570.7216186523438, 270.426025390625],
                  [566.1362915039062, 275.6894226074219],
                  [559.7174072265625, 277.4383239746094],
                  [555.27001953125, 278.38983154296875],
                  [550.76416015625, 278.224609375],
                  [544.5654296875, 276.5538330078125],
                  [540.4971313476562, 271.23443603515625],
                  [551.1065063476562, 269.21295166015625],
                  [555.1461791992188, 269.2280578613281],
                  [559.085693359375, 269.2560729980469],
                  [570.5288696289062, 270.49652099609375],
                  [559.5015869140625, 273.13885498046875],
                  [555.2052001953125, 273.3490295410156],
                  [550.8341674804688, 273.66259765625]]

keypoints_std = [[258.6517333984375, 129.6844482421875],
                 [271.243408203125, 114.19739532470703],
                 [250.7386474609375, 115.18934631347656],
                 [290.9837951660156, 112.6287841796875],
                 [249.19618225097656, 115.92790985107422],
                 [329.2179260253906, 180.10240173339844],
                 [247.29208374023438, 180.1289520263672],
                 [403.0504455566406, 322.79345703125],
                 [282.3704833984375, 302.9095458984375],
                 [396.5852355957031, 312.5275573730469],
                 [289.9548645019531, 292.88177490234375],
                 [287.1123352050781, 570.041015625],
                 [250.66064453125, 578.4175415039062],
                 [323.1044616699219, 844.5531616210938],
                 [238.9808807373047, 842.4541015625],
                 [307.1580810546875, 1125.8846435546875],
                 [245.992431640625, 1134.410888671875],
                 [327.3326721191406, 1203.7908935546875],
                 [361.49853515625, 1198.8450927734375],
                 [316.54168701171875, 1143.781005859375],
                 [242.16883850097656, 1206.8643798828125],
                 [253.41087341308594, 1203.2470703125],
                 [250.6615753173828, 1164.13427734375],
                 [396.923583984375, 317.7442932128906],
                 [380.13531494140625, 314.804443359375],
                 [371.2118835449219, 318.99261474609375],
                 [367.08294677734375, 319.8166809082031],
                 [363.07623291015625, 328.2082214355469],
                 [386.8450012207031, 305.4447021484375],
                 [384.8190612792969, 309.6307067871094],
                 [381.6959533691406, 321.91790771484375],
                 [377.1261901855469, 335.0472106933594],
                 [399.00897216796875, 310.358642578125],
                 [398.36395263671875, 318.4856872558594],
                 [394.48712158203125, 331.7388916015625],
                 [389.3145446777344, 346.18756103515625],
                 [409.6855163574219, 320.6112060546875],
                 [407.4671936035156, 328.3492736816406],
                 [402.1263427734375, 341.1282043457031],
                 [395.13006591796875, 352.0581970214844],
                 [416.8207092285156, 330.4665832519531],
                 [416.5738830566406, 338.8221130371094],
                 [412.4542541503906, 348.837646484375],
                 [406.1687927246094, 357.3872985839844],
                 [289.0446472167969, 297.5413513183594],
                 [280.7959289550781, 294.20330810546875],
                 [278.1346740722656, 296.8888854980469],
                 [277.7769775390625, 296.11614990234375],
                 [278.4560546875, 302.66400146484375],
                 [285.5188293457031, 280.6957702636719],
                 [287.4402770996094, 281.9640197753906],
                 [288.4915466308594, 292.5968017578125],
                 [289.3487854003906, 304.0662841796875],
                 [293.70977783203125, 283.26202392578125],
                 [296.9166564941406, 288.0068359375],
                 [297.4468994140625, 299.5704650878906],
                 [297.52862548828125, 312.8245849609375],
                 [301.3831481933594, 291.9615173339844],
                 [303.2591857910156, 296.8460388183594],
                 [302.914794921875, 308.6287841796875],
                 [300.79205322265625, 318.76947021484375],
                 [307.12579345703125, 301.3664855957031],
                 [309.52764892578125, 307.6034240722656],
                 [309.2758483886719, 316.4548645019531],
                 [307.31982421875, 324.7281799316406],
                 [244.3591766357422, 112.98299407958984],
                 [244.03907775878906, 117.87863159179688],
                 [244.31460571289062, 124.24026489257812],
                 [244.8857879638672, 131.25621032714844],
                 [246.11978149414062, 139.32528686523438],
                 [248.19223022460938, 147.74671936035156],
                 [251.74607849121094, 156.0677947998047],
                 [256.0296630859375, 162.1208953857422],
                 [261.0466003417969, 163.8029022216797],
                 [267.05291748046875, 161.3515167236328],
                 [273.1693420410156, 154.87449645996094],
                 [279.6466064453125, 145.97067260742188],
                 [284.4530944824219, 137.29727172851562],
                 [287.58099365234375, 129.23121643066406],
                 [289.492431640625, 122.57501983642578],
                 [290.07916259765625, 116.69871520996094],
                 [289.7974548339844, 112.27108001708984],
                 [245.5869140625, 113.65293884277344],
                 [246.68174743652344, 113.10681915283203],
                 [249.4249267578125, 113.61614990234375],
                 [252.94207763671875, 113.9015884399414],
                 [256.3514099121094, 114.1834487915039],
                 [261.97967529296875, 113.95765686035156],
                 [266.29705810546875, 113.40238189697266],
                 [272.02569580078125, 112.80184936523438],
                 [278.3409118652344, 111.87450408935547],
                 [282.53887939453125, 122.28547668457031],
                 [258.9786071777344, 125.8990249633789],
                 [258.77691650390625, 128.08287048339844],
                 [258.62493896484375, 131.3507080078125],
                 [258.5524597167969, 135.12709045410156],
                 [255.35244750976562, 136.25218200683594],
                 [257.07574462890625, 137.4909210205078],
                 [258.9935302734375, 138.31451416015625],
                 [261.1419677734375, 137.62826538085938],
                 [263.12994384765625, 135.92428588867188],
                 [248.06687927246094, 126.48417663574219],
                 [249.58604431152344, 126.74288940429688],
                 [251.99688720703125, 126.79525756835938],
                 [254.24761962890625, 126.24832153320312],
                 [252.02987670898438, 127.25780487060547],
                 [249.99404907226562, 127.62664031982422],
                 [265.63323974609375, 126.64830017089844],
                 [268.2939453125, 125.6734619140625],
                 [272.0563659667969, 125.8868179321289],
                 [275.5439453125, 125.79682922363281],
                 [271.6081237792969, 126.89498901367188],
                 [269.6185302734375, 124.0280532836914],
                 [254.4313507080078, 144.37301635742188],
                 [255.7751922607422, 142.60232543945312],
                 [258.5469970703125, 142.14662170410156],
                 [260.3607177734375, 142.60690307617188],
                 [262.36834716796875, 141.98838806152344],
                 [265.9646911621094, 142.4713592529297],
                 [268.9481201171875, 144.1527862548828],
                 [266.2673645019531, 147.3036346435547],
                 [262.9518737792969, 148.25877380371094],
                 [260.79736328125, 149.05638122558594],
                 [258.77197265625, 149.03958129882812],
                 [256.2879638671875, 148.0755157470703],
                 [254.82696533203125, 144.77206420898438],
                 [258.95428466796875, 144.47601318359375],
                 [260.7057800292969, 144.52386474609375],
                 [262.6152648925781, 144.47259521484375],
                 [268.9339904785156, 143.9291534423828],
                 [262.87200927734375, 145.82997131347656],
                 [260.8111877441406, 146.1022491455078],
                 [258.8911437988281, 146.33717346191406]]

codec = dict(
    type='ImagePoseLifting',
    num_keypoints=133,
    root_index=(11, 12),
    remove_root=False,
    target_mean=target_mean,
    target_std=target_std,
    keypoints_mean=keypoints_mean,
    keypoints_std=keypoints_std)

# model settings
model = dict(
    type='PoseLifter',
    backbone=dict(
        type='LargeSimpleBaseline', in_channels=133 * 2, channels=1024),
    head=dict(
        type='TemporalRegressionHead',
        in_channels=1024,
        num_joints=133,
        loss=dict(type='MSELoss'),
        decoder=codec,
    ))

# pipelines
train_pipeline = [
    dict(type='GenerateTarget', encoder=codec),
    dict(
        type='PackPoseInputs',
        meta_keys=('id', 'category_id', 'target_img_path', 'flip_indices',
                   'target_root', 'target_root_index', 'target_mean',
                   'target_std'))
]
val_pipeline = train_pipeline

# h3wb dataset
h3wb_dataset = dict(
    type='H3WBDataset',
    ann_file='annotation_body3d/h3wb_train.npz',
    seq_len=1,
    causal=True,
    data_root='data/h36m/',
    data_prefix=dict(img='images/'),
    pipeline=[],
)

# coco dataset
coco_dataset = dict(
    type='COCOWholebody3D',
    ann_file='MSCOCO_train.npz',
    seq_len=1,
    causal=True,
    data_root='data/coco/',
    data_prefix=dict(img=''),
    pipeline=[],
)

# mpii dataset
mpii_dataset = dict(
    type='MPII3DWBDataset',
    ann_file='mpii_train.npz',
    seq_len=1,
    causal=True,
    data_root='data/mpii/',
    data_prefix=dict(img=''),
    pipeline=[],
)

# ubody dataset
scenes = [
    'Magic_show', 'Entertainment', 'ConductMusic', 'Online_class', 'TalkShow',
    'Speech', 'Fitness', 'Interview', 'Olympic', 'TVShow', 'Singing',
    'SignLanguage', 'Movie', 'LiveVlog', 'VideoConference'
]
ubody_datasets = []
for scene in scenes:
    train_ann = f'annotations/{scene}/train_3dkeypoint_annotation.json'
    ubody = dict(
        type='UBody3dDataset',
        data_root='data/UBody/',
        ann_file=train_ann,
        data_mode='topdown',
        causal=True,
        seq_len=1,
        data_prefix=dict(img='images/'),
        subset_frac=0.1,
        pipeline=[])
    ubody_datasets.append(ubody)

# data loaders
train_dataloader = dict(
    batch_size=64,
    num_workers=4,
    persistent_workers=True,
    sampler=dict(type='DefaultSampler', shuffle=True),
    dataset=dict(
        type='CombinedDataset',
        datasets=[h3wb_dataset, mpii_dataset, coco_dataset, *ubody_datasets],
        pipeline=train_pipeline,
        metainfo=dict(from_file='configs/_base_/datasets/h3wb.py'),
        test_mode=False))
val_dataloader = dict(
    batch_size=512,
    num_workers=2,
    persistent_workers=True,
    drop_last=False,
    sampler=dict(type='DefaultSampler', shuffle=False, round_up=False),
    dataset=dict(
        type='H3WBDataset',
        ann_file='annotation_body3d/h3wb_train.npz',
        seq_len=1,
        causal=True,
        data_root='data/h36m/',
        data_prefix=dict(img='images/'),
        pipeline=train_pipeline,
        train_mode=False,
    ))
test_dataloader = val_dataloader

# evaluators
val_evaluator = [
    dict(type='SimpleMPJPE', mode='mpjpe'),
    dict(type='SimpleMPJPE', mode='p-mpjpe')
]
test_evaluator = val_evaluator
